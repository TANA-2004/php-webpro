<?php
// ไฟล์นี้จะถูกเรียกใช้โดยไฟล์อื่นในโฟลเดอร์ admin
// เราจึงต้องใช้ __DIR__ . '/../' เพื่อถอยหลัง 1 ชั้น ไปหา config.php ที่อยู่ข้างนอก
require_once __DIR__ . '/../config.php'; 

// --- [ด่านตรวจ] ---
// ตรวจสอบ 3 อย่าง:
// 1. ยังไม่ล็อกอิน? (ไม่มี user_id)
// 2. ไม่มี role?
// 3. role ไม่ใช่ 'admin'?
if (!isset($_SESSION['user_id']) || !isset($_SESSION['role']) || $_SESSION['role'] !== 'admin') {
    
    // ถ้าไม่ผ่านข้อใดข้อหนึ่ง ให้เตะกลับไปหน้าบ้าน
    
    // (ทางเลือก) ตั้งค่าข้อความแจ้งเตือน
    $_SESSION['message'] = "คุณไม่มีสิทธิ์เข้าถึงส่วนนี้";
    $_SESSION['is_success'] = false;
    
    // ส่งกลับไปหน้าแรกของ "หน้าบ้าน" (../index.php)
    header('Location: ../index.php'); 
    exit();
}

// ถ้าโค้ดวิ่งมาถึงบรรทัดนี้ได้...
// แสดงว่า "เป็นแอดมินตัวจริง"
// เราดึงชื่อแอดมินจาก Session มาเตรียมไว้ใช้ทักทายในหน้าต่างๆ
$admin_fullname = $_SESSION['user']['fullname'] ?? 'Admin';

?>